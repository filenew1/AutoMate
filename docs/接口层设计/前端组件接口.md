# 前端组件接口

本文档定义了AutoMate项目中React组件的接口规范。

## 1. 组件接口概述

### 1.1 接口定义原则

- 使用TypeScript接口定义组件Props
- 所有Props必须提供类型注解
- 可选Props使用`?`标记
- 为Props提供默认值
- 使用泛型提高组件复用性

### 1.2 组件分类

- **容器组件**：负责状态管理和数据获取
- **展示组件**：负责UI展示，通过Props接收数据
- **布局组件**：负责页面布局
- **功能组件**：提供特定功能（如按钮、输入框等）

## 2. 智能体模块组件接口

### 2.1 AgentList组件

**组件描述：**

智能体列表组件，显示所有智能体及其分组。

**Props接口：**

```typescript
interface AgentListProps {
  agents: Agent[];
  groups: Group[];
  selectedAgentId: string | null;
  onAgentSelect: (agent: Agent) => void;
  onGroupToggle: (groupId: string) => void;
  searchTerm: string;
  loading?: boolean;
}

interface Agent {
  id: string;
  name: string;
  description: string;
  avatar: string;
  type: AgentType;
  group_name: string;
  online_status: boolean;
  response_time: number;
}

interface Group {
  id: string;
  name: string;
  expanded: boolean;
  agents: Agent[];
}

type AgentType = 'chat' | 'code' | 'data';
```

**使用示例：**

```tsx
<AgentList
  agents={agents}
  groups={groups}
  selectedAgentId={selectedAgentId}
  onAgentSelect={handleAgentSelect}
  onGroupToggle={handleGroupToggle}
  searchTerm={searchTerm}
  loading={loading}
/>
```

### 2.2 AgentItem组件

**组件描述：**

智能体列表项组件，显示单个智能体信息。

**Props接口：**

```typescript
interface AgentItemProps {
  agent: Agent;
  selected: boolean;
  onSelect: (agent: Agent) => void;
  onHover?: (agent: Agent) => void;
}
```

**使用示例：**

```tsx
<AgentItem
  agent={agent}
  selected={selected}
  onSelect={handleAgentSelect}
  onHover={handleAgentHover}
/>
```

### 2.3 SearchInput组件

**组件描述：**

搜索输入框组件，用于搜索智能体。

**Props接口：**

```typescript
interface SearchInputProps {
  value: string;
  onChange: (value: string) => void;
  onClear?: () => void;
  placeholder?: string;
  loading?: boolean;
}
```

**使用示例：**

```tsx
<SearchInput
  value={searchTerm}
  onChange={handleSearchChange}
  onClear={handleSearchClear}
  placeholder="搜索智能体..."
  loading={searching}
/>
```

## 3. 聊天交互模块组件接口

### 3.1 ChatWindow组件

**组件描述：**

聊天窗口组件，显示聊天消息和输入框。

**Props接口：**

```typescript
interface ChatWindowProps {
  agent: Agent;
  messages: Message[];
  loading?: boolean;
  onSendMessage: (content: string) => void;
  onFileUpload?: (file: File) => void;
  onMessageCopy?: (content: string) => void;
  onMessageDelete?: (messageId: string) => void;
}

interface Message {
  id: string;
  content: string;
  message_type: 'user' | 'agent';
  send_time: Date;
  status: MessageStatus;
  has_attachment: boolean;
  attachment_path?: string;
}

type MessageStatus = 'sent' | 'delivered' | 'read' | 'failed';
```

**使用示例：**

```tsx
<ChatWindow
  agent={selectedAgent}
  messages={messages}
  loading={loading}
  onSendMessage={handleSendMessage}
  onFileUpload={handleFileUpload}
  onMessageCopy={handleMessageCopy}
  onMessageDelete={handleMessageDelete}
/>
```

### 3.2 MessageBubble组件

**组件描述：**

消息气泡组件，显示单条消息。

**Props接口：**

```typescript
interface MessageBubbleProps {
  message: Message;
  isOwn: boolean;
  onCopy?: (content: string) => void;
  onDelete?: (messageId: string) => void;
  onReply?: (message: Message) => void;
}
```

**使用示例：**

```tsx
<MessageBubble
  message={message}
  isOwn={message.message_type === 'user'}
  onCopy={handleMessageCopy}
  onDelete={handleMessageDelete}
  onReply={handleMessageReply}
/>
```

### 3.3 MessageInput组件

**组件描述：**

消息输入框组件，用于输入和发送消息。

**Props接口：**

```typescript
interface MessageInputProps {
  value: string;
  onChange: (value: string) => void;
  onSend: (content: string) => void;
  onFileUpload?: (file: File) => void;
  disabled?: boolean;
  loading?: boolean;
  placeholder?: string;
  maxLength?: number;
}
```

**使用示例：**

```tsx
<MessageInput
  value={inputValue}
  onChange={handleInputChange}
  onSend={handleSendMessage}
  onFileUpload={handleFileUpload}
  disabled={!selectedAgent}
  loading={sending}
  placeholder="输入消息..."
  maxLength={10000}
/>
```

### 3.4 FileUpload组件

**组件描述：**

文件上传组件，用于上传文件附件。

**Props接口：**

```typescript
interface FileUploadProps {
  onUpload: (file: File) => void;
  acceptedTypes?: string[];
  maxSize?: number;
  multiple?: boolean;
  loading?: boolean;
}
```

**使用示例：**

```tsx
<FileUpload
  onUpload={handleFileUpload}
  acceptedTypes={['image/*', 'application/pdf']}
  maxSize={10 * 1024 * 1024}
  multiple={false}
  loading={uploading}
/>
```

## 4. 主题模块组件接口

### 4.1 ThemeProvider组件

**组件描述：**

主题提供者组件，提供主题上下文。

**Props接口：**

```typescript
interface ThemeProviderProps {
  children: React.ReactNode;
  defaultTheme?: Theme;
}

type Theme = 'light' | 'dark';
```

**使用示例：**

```tsx
<ThemeProvider defaultTheme="light">
  <App />
</ThemeProvider>
```

### 4.2 ThemeToggle组件

**组件描述：**

主题切换组件，用于切换主题。

**Props接口：**

```typescript
interface ThemeToggleProps {
  theme: Theme;
  onToggle: (theme: Theme) => void;
  size?: 'small' | 'medium' | 'large';
}
```

**使用示例：**

```tsx
<ThemeToggle
  theme={currentTheme}
  onToggle={handleThemeToggle}
  size="medium"
/>
```

## 5. 启动页模块组件接口

### 5.1 WelcomePage组件

**组件描述：**

欢迎页组件，显示应用欢迎信息。

**Props接口：**

```typescript
interface WelcomePageProps {
  agentCount: number;
  skillCount: number;
  conversationCount: number;
  onGetStarted: () => void;
  loading?: boolean;
}
```

**使用示例：**

```tsx
<WelcomePage
  agentCount={agentCount}
  skillCount={skillCount}
  conversationCount={conversationCount}
  onGetStarted={handleGetStarted}
  loading={loading}
/>
```

### 5.2 StatCard组件

**组件描述：**

统计卡片组件，显示统计信息。

**Props接口：**

```typescript
interface StatCardProps {
  value: number;
  label: string;
  icon?: React.ReactNode;
  color?: string;
  loading?: boolean;
}
```

**使用示例：**

```tsx
<StatCard
  value={agentCount}
  label="可用智能体"
  icon={<AgentIcon />}
  color="#3b82f6"
  loading={loading}
/>
```

## 6. 通用组件接口

### 6.1 Button组件

**组件描述：**

通用按钮组件。

**Props接口：**

```typescript
interface ButtonProps {
  children: React.ReactNode;
  onClick?: () => void;
  disabled?: boolean;
  loading?: boolean;
  variant?: 'primary' | 'secondary' | 'danger' | 'ghost';
  size?: 'small' | 'medium' | 'large';
  fullWidth?: boolean;
  type?: 'button' | 'submit' | 'reset';
}

type ButtonVariant = 'primary' | 'secondary' | 'danger' | 'ghost';
type ButtonSize = 'small' | 'medium' | 'large';
```

**使用示例：**

```tsx
<Button
  onClick={handleClick}
  disabled={disabled}
  loading={loading}
  variant="primary"
  size="medium"
>
  点击我
</Button>
```

### 6.2 Input组件

**组件描述：**

通用输入框组件。

**Props接口：**

```typescript
interface InputProps {
  value: string;
  onChange: (value: string) => void;
  placeholder?: string;
  disabled?: boolean;
  error?: string;
  type?: 'text' | 'password' | 'email' | 'number';
  size?: 'small' | 'medium' | 'large';
  fullWidth?: boolean;
  maxLength?: number;
}
```

**使用示例：**

```tsx
<Input
  value={inputValue}
  onChange={handleChange}
  placeholder="请输入..."
  error={error}
  type="text"
  size="medium"
  fullWidth
/>
```

### 6.3 Modal组件

**组件描述：**

模态框组件。

**Props接口：**

```typescript
interface ModalProps {
  open: boolean;
  onClose: () => void;
  title?: string;
  children: React.ReactNode;
  size?: 'small' | 'medium' | 'large';
  showCloseButton?: boolean;
  closeOnOverlayClick?: boolean;
  closeOnEscape?: boolean;
}

type ModalSize = 'small' | 'medium' | 'large';
```

**使用示例：**

```tsx
<Modal
  open={isOpen}
  onClose={handleClose}
  title="标题"
  size="medium"
  showCloseButton
>
  <p>模态框内容</p>
</Modal>
```

### 6.4 LoadingSpinner组件

**组件描述：**

加载指示器组件。

**Props接口：**

```typescript
interface LoadingSpinnerProps {
  size?: 'small' | 'medium' | 'large';
  color?: string;
  text?: string;
}
```

**使用示例：**

```tsx
<LoadingSpinner
  size="medium"
  color="#3b82f6"
  text="加载中..."
/>
```

### 6.5 Toast组件

**组件描述：**

提示消息组件。

**Props接口：**

```typescript
interface ToastProps {
  message: string;
  type?: 'success' | 'error' | 'warning' | 'info';
  duration?: number;
  onClose?: () => void;
}

type ToastType = 'success' | 'error' | 'warning' | 'info';
```

**使用示例：**

```tsx
<Toast
  message="操作成功"
  type="success"
  duration={3000}
  onClose={handleClose}
/>
```

## 7. 自定义Hooks接口

### 7.1 useAgentList Hook

**Hook描述：**

获取智能体列表的Hook。

**Hook接口：**

```typescript
interface UseAgentListResult {
  agents: Agent[];
  loading: boolean;
  error: Error | null;
  reload: () => Promise<void>;
}

function useAgentList(): UseAgentListResult;
```

**使用示例：**

```
const { agents, loading, error, reload } = useAgentList();

if (loading) return <LoadingSpinner />;
if (error) return <ErrorMessage error={error} />;

return <AgentList agents={agents} />;
```

### 7.2 useChatMessages Hook

**Hook描述：**

获取聊天消息的Hook。

**Hook接口：**

```typescript
interface UseChatMessagesResult {
  messages: Message[];
  loading: boolean;
  error: Error | null;
  sendMessage: (content: string) => Promise<void>;
  loadMore: () => Promise<void>;
  hasMore: boolean;
}

function useChatMessages(agentId: string): UseChatMessagesResult;
```

**使用示例：**

```tsx
const { messages, loading, sendMessage, hasMore } = useChatMessages(agentId);

return (
  <ChatWindow
    agent={agent}
    messages={messages}
    loading={loading}
    onSendMessage={sendMessage}
  />
);
```

### 7.3 useTheme Hook

**Hook描述：**

管理主题的Hook。

**Hook接口：**

```typescript
interface UseThemeResult {
  theme: Theme;
  toggleTheme: () => void;
  setTheme: (theme: Theme) => void;
}

function useTheme(): UseThemeResult;
```

**使用示例：**

```tsx
const { theme, toggleTheme } = useTheme();

return (
  <button onClick={toggleTheme}>
    切换到{theme === 'light' ? '深色' : '浅色'}主题
  </button>
);
```

## 8. Context接口

### 8.1 AgentContext

**Context描述：**

智能体上下文，提供智能体相关的全局状态。

**Context接口：**

```typescript
interface AgentContextValue {
  agents: Agent[];
  selectedAgent: Agent | null;
  loading: boolean;
  error: Error | null;
  selectAgent: (agent: Agent) => void;
  loadAgents: () => Promise<void>;
}

const AgentContext = React.createContext<AgentContextValue | null>(null);
```

**使用示例：**

```tsx
// 提供Context
<AgentProvider>
  <App />
</AgentProvider>

// 使用Context
const { agents, selectedAgent, selectAgent } = useAgentContext();
```

### 8.2 ChatContext

**Context描述：**

聊天上下文，提供聊天相关的全局状态。

**Context接口：**

```typescript
interface ChatContextValue {
  messages: Message[];
  loading: boolean;
  error: Error | null;
  sendMessage: (content: string) => Promise<void>;
  loadMessages: (agentId: string) => Promise<void>;
}

const ChatContext = React.createContext<ChatContextValue | null>(null);
```

**使用示例：**

```tsx
// 提供Context
<ChatProvider>
  <ChatWindow />
</ChatProvider>

// 使用Context
const { messages, sendMessage } = useChatContext();
```

### 8.3 ThemeContext

**Context描述：**

主题上下文，提供主题相关的全局状态。

**Context接口：**

```typescript
interface ThemeContextValue {
  theme: Theme;
  toggleTheme: () => void;
  setTheme: (theme: Theme) => void;
}

const ThemeContext = React.createContext<ThemeContextValue | null>(null);
```

**使用示例：**

```tsx
// 提供Context
<ThemeProvider>
  <App />
</ThemeProvider>

// 使用Context
const { theme, toggleTheme } = useThemeContext();
```

## 9. 类型定义

### 9.1 通用类型

```typescript
// ID类型
type ID = string;

// 时间戳类型
type Timestamp = Date | string | number;

// 可选类型
type Optional<T> = T | null | undefined;

// 分页参数
interface PaginationParams {
  page: number;
  pageSize: number;
}

// 分页结果
interface PaginationResult<T> {
  data: T[];
  total: number;
  page: number;
  pageSize: number;
}
```

### 9.2 API响应类型

```typescript
// 成功响应
interface ApiResponse<T> {
  code: number;
  message: string;
  data: T;
}

// 错误响应
interface ApiError {
  code: number;
  message: string;
  details?: any;
}
```

## 10. 组件开发规范

### 10.1 组件命名

- 组件名称使用PascalCase
- 组件文件名与组件名称一致
- 示例：`AgentList.tsx` -> `AgentList`组件

### 10.2 Props定义

- 使用interface定义Props
- Props名称使用camelCase
- 回调函数以`on`开头
- 示例：`onAgentSelect`, `onMessageSend`

### 10.3 组件导出

- 默认导出主要组件
- 命名导出辅助组件和类型
- 示例：
  ```tsx
  export default AgentList;
  export { AgentItem };
  export type { AgentListProps, AgentItemProps };
  ```

### 10.4 组件文档

- 为每个组件添加JSDoc注释
- 说明组件用途和Props
- 示例：
  ```tsx
  /**
   * AgentList - 智能体列表组件
   *
   * @param agents - 智能体列表
   * @param onAgentSelect - 智能体选择回调
   * @param searchTerm - 搜索关键词
   */
  const AgentList: React.FC<AgentListProps> = ({ agents, onAgentSelect, searchTerm }) => {
    // 组件实现
  };
  ```

## 11. 参考资源

- [React官方文档 - 组件和Props](https://react.dev/learn/passing-props-to-a-component)
- [TypeScript官方文档 - 类型定义](https://www.typescriptlang.org/docs/handbook/2/types-from-types.html)
- [开发环境配置规范](../基础规范/开发环境配置.md)
